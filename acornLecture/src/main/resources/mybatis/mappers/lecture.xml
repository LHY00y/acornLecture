<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	
<mapper namespace="mapper.lecture">
	<resultMap type="lectureDTO" id="lecResult">
		<result property="lecture_id" column="lecture_id" />
		<result property="lecture_title" column="lecture_title" />
		<result property="professor_id" column="professor_id" />
		<result property="professor_name" column="professor_name" />
		<result property="category" column="category" />
		<result property="count" column="count" />
		<result property="shedule" column="schedule" />
		<result property="lecture_content" column="lecture_content" />
	</resultMap>

	
	<select id="selectAllLectureList" resultType="lectureDTO">
		<![CDATA[
			select lecture.*, members.member_name as professor_name from lecture 
				inner join members
				on lecture.professor_id = members.member_id
				order by lecture_id desc
		]]>
	</select>
	
	<select id="selectAllCategories" resultType="String">
		<![CDATA[
			select distinct category from lecture order by category asc
		]]>
	</select>

	<select id="selectSearchLectureList" parameterType="String" resultType="lectureDTO">
		<![CDATA[
			select lecture.*, members.member_name as professor_name from lecture
				inner join members
				on lecture.professor_id = members.member_id
				where lecture_title LIKE '%'||#{keyword}||'%' 
				order by lecture_id desc
		]]>
	</select>
	
	<select id="selectOneLecture" parameterType="int" resultType="lectureDTO">
		<![CDATA[
			select lecture.*, members.member_name as professor_name from lecture 
				inner join members
                on lecture.professor_id = members.member_id
                where lecture.lecture_id = #{lecture_id}
				order by lecture_id desc
		]]>
	</select>
	
	<select id="chkLecture" parameterType="Map" resultType="lectureDTO">
		<![CDATA[
			select * from member_lecture 
				where member_id = #{member_id}
				and lecture_id = #{lecture_id} 
		]]>
	</select>
	
		<insert id="insertNewLecture" parameterType="java.util.Map">
		<![CDATA[	
			insert into lecture 
				values(#{lectureNo}, #{title}, #{member_id}, #{category}, #{count}, #{time} ,#{content})
		]]>		
	</insert>
	
		<select id="selectNewLectureNo" resultType="int">
		<![CDATA[
			select max(lecture_id)+1 from lecture
		]]>
	</select>
</mapper>